Index: mercurial-1.0.1/mercurial/hgweb/protocol.py
===================================================================
--- mercurial-1.0.1.orig/mercurial/hgweb/protocol.py	2008-10-03 16:24:51.000000000 +0200
+++ mercurial-1.0.1/mercurial/hgweb/protocol.py	2008-10-03 16:25:01.000000000 +0200
@@ -224,5 +224,7 @@
         os.unlink(tempname)
 
 def stream_out(web, req):
+    if not web.allowpull:
+        return
     req.respond(HTTP_OK, HGTYPE)
     streamclone.stream_out(web.repo, req, untrusted=True)
